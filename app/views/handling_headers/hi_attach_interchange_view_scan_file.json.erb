{
 "success": true,
 "items": [
  {
   xtype: 'panel',
   flex: 1,
   layout: 'fit',
     defaults: {
     	 xtype: 'textfield',
     	 margin: '10 10 0 10',
     },	  
   autoScroll: true,
   
   
   listeners: {
   	afterrender: function(comp){   	
   		//comp.up('window').maximize();
   		comp.down('container').down('panel').setHeight(900);
   		comp.down('container').down('panel').setWidth('auto');
   		comp.up('window').setHeight(450);
   		comp.up('window').doLayout();   		   		
    }
   },
   
   
      items: [    	
    	    {
     			xtype: 'container',
     			flex: 1,
     			height: '100%',
     			autoScroll: true,
     			items: [
		    	    {
		     			xtype: 'panel',
		     			//flex: 1,
		     			html: '<img src=<%= raw @item.scan_file.url(:original).to_json %> style="max-height: 900px; width: auto;">',
		     			//src: <%= raw @item.scan_file.url(:original).to_json %>,
		     			mode : 'image'
		    		}     			
     			]
    		}
	], 
   
   
	
	buttons: [
		{
            text: 'Elimina',
            cls: 'btn-del',
            handler: function (btn, evt) {
            	var tmp_win = this.up('window');
            	
						Ext.MessageBox.confirm('Richieta conferma', 'Eliminare il file corrente?', function(btn){												
							if(btn === 'yes'){            	
            	
							  Ext.Ajax.request({
				                    url: <%= raw url_for(:action=>'hi_delete_interchange_exe').to_json -%>,
				                    waitMsg: 'Salvataggio in corso....',
									method:'POST',                    
				                    jsonData: {id: <%= @item.id -%>},	
				             	
									success: function(result, request) {					
										var returnData = Ext.JSON.decode(result.responseText);
										
										//error
										if (returnData.success == false){
											Ext.MessageBox.show({
						                        title: 'EXCEPTION',
						                        msg: returnData.message,
						                        icon: Ext.MessageBox.ERROR,
						                        buttons: Ext.Msg.OK
					                    	})
					                      return false;										
										}								
						 							
						            	tmp_win.open_vars.mov_panel.down('grid').store.reload();
						            	tmp_win.close();
						 							
									}, scope: this,
									
									failure: function(rec, op) {
										var result = Ext.JSON.decode(op.getResponse().responseText);
										Ext.MessageBox.show({
					                        title: 'EXCEPTION',
					                        msg: result.message,
					                        //icon: Ext.MessageBox.ERROR,
					                        buttons: Ext.Msg.OK
				                    	})					
									}, scope: this,						
													 
						    	});
						    }
						  }); //confirm  	            	
            	
            	
    		}
	     }, {xtype: 'tbfill'}, {
            text : '<i class="fa fa-print" style="color:white;"></i> Stampa',            
            handler: function (btn, evt) {
            	tmp_win = this.up('window').down('panel').down('container').down('panel');
            	console.log(tmp_win);
            	tmp_html = Ext.dom.Query.selectNode('#' + tmp_win.id);
				plugin.Printer.print(tmp_html, true);
    		}
	     }, {
            text: 'Chiudi',
            handler: function (btn, evt) {
            	this.up('window').close();
    		}
	     }	
	]
	
  }
 ]
}	